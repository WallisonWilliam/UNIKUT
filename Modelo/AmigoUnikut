package Unikut.Modelo;

import java.util.Scanner;
import Unikut.Controle.Conta;
import Unikut.Controle.Node;

public class AmigoUnikut {
    Scanner in = new Scanner (System.in);
    Scanner input = new Scanner (System.in);
    Node aux;

    public void opAmigo(ListaUnikut listCont, Conta cont) {
        char opAmg;
        String emailAmg;
        Conta contAmg;
        ListaUnikut listAmg = new ListaUnikut();
        if (cont.getNome().equals("Convidado") == true) {
            System.out.print("É necessário que você adicione um nome para o seu perfil.");
            System.out.println(" Assim, você poderá utilizar o menu de amizade.");
            return;
        }
        MenuAmg();
        do {
            System.out.println("Menu de amizade.");
            System.out.println();
            System.out.println("Digite 4 para ver o menu novamente.");
            System.out.print("Digite aqui: ");
            opAmg = in.next().charAt(0);
            if (opAmg == '1' || opAmg == '2') {
                System.out.print("Informe o email do usuário desejado: ");
                emailAmg = input.nextLine();
                contAmg = new Conta(emailAmg);
                aux = listCont.buscaList(contAmg);
                if (aux == null) {
                    System.out.println("O usuário não faz parte da Unikut.");
                }
                else if (aux.getInfo().compareTo(cont) == 0) {
                    System.out.println("Não é possível mandar ou aceitar solicitação de amizade para si mesmo.");
                }
                else if (opAmg == '1') {
                    amigoLista(listAmg, contAmg);
                }
                else {
                    aceitaAmizade(listAmg, contAmg);
                }
            }
            else if (opAmg == '3') {
                listAmg.vizlAmg();
            }
            else if (opAmg == '4') {
                MenuAmg();
            }
            else if (opAmg == '0') {
                System.out.println("Voltando para o menu do perfil.");
            }
            else {
                System.out.println("Opção inválida.");
            }
        } while (opAmg != '0');
    }

    public void amigoLista(ListaUnikut listAmg, Conta contAmg) {
        boolean validAmg, nome = false;
        validAmg = listAmg.incerirConta(contAmg, nome);
        aux = listAmg.buscaList(contAmg);
        if (validAmg == true) {
            contAmg.setStatAmiz("Pendente");
            aux.setInfo(contAmg);
            System.out.println("Solicitação enviada. O status de amizade ficará como pendente.");
        }
        else {
            System.out.println("O usuário é seu amigo ou já está na sua lista de solicitações.");
        }
    }


    public void aceitaAmizade(ListaUnikut listAmg, Conta contAmg) {
        String status;
        status = contAmg.getStatAmiz();
        if (status.equals("Pendente") == true) {
            aux = listAmg.buscaList(contAmg);
            contAmg.setStatAmiz("Amigo");
            aux.setInfo(contAmg);
            System.out.println("Solicitação aceita.");
        }
        else {
            System.out.println("O usuário já é seu amigo na Unikut.");
        }
    }

    public void MenuAmg() {
        System.out.println("Opções do menu de amigos:");
        System.out.println("1 - Enviar uma solicitação de amizade.");
        System.out.println("2 - Aceitar solicitações de amizade.");
        System.out.println("3 - Visualizar status de amizade.");
        System.out.println("0 - Voltar para o menu inicial.");
    }
}
